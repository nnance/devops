<!DOCTYPE html>
<html>
<head>
<title>Node.js &amp; Mongo DB on Aws Ec2 and EBS - Murvin Lai</title>
<meta name='description' content='Node.js &amp; Mongo DB on AWS EC2 and EBS' />
<meta name='keywords' content='Node.js, MongoDB, AWS Ec2, Git, install' />
<meta property='og:site_name' content='Murvin Lai' />
<meta property='og:title' content='Node.js &amp; Mongo DB on Aws Ec2 and EBS' />
<meta property='og:description' content='Node.js &amp; Mongo DB on AWS EC2 and EBS' />
<meta property='og:url' content='http://www.murvinlai.com/nodejs--mongodb-on-aws.html' />

<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<link rel="stylesheet" href="//cdn2.editmysite.com/css/sites.css?buildTime=1376434471" type="text/css" /><link rel='stylesheet' type='text/css' href='http://cdn1.editmysite.com/editor/libraries/fancybox/fancybox.css?1376434471' />
<link rel='stylesheet' type='text/css' href='/files/main_style.css?1376435937' title='wsite-theme-css' />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,300italic,700,400italic,700italic' rel='stylesheet' type='text/css' />
<style type='text/css'>
.wsite-elements div.paragraph, .wsite-elements p, .wsite-elements .product-block .product-title, .wsite-elements .product-description, .wsite-elements .wsite-form-field label, .wsite-elements .wsite-form-field label, #wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {}
#wsite-content div.paragraph, #wsite-content p, #wsite-content .product-block .product-title, #wsite-content .product-description, #wsite-content .wsite-form-field label, #wsite-content .wsite-form-field label, .blog-sidebar div.paragraph, .blog-sidebar p, .blog-sidebar .wsite-form-field label, .blog-sidebar .wsite-form-field label {}
.wsite-elements h2, .wsite-elements .product-long .product-title, .wsite-elements .product-large .product-title, .wsite-elements .product-small .product-title, #wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {}
#wsite-content h2, #wsite-content .product-long .product-title, #wsite-content .product-large .product-title, #wsite-content .product-small .product-title, .blog-sidebar h2 {}
#wsite-title {}
</style>
<script><!--
var STATIC_BASE = 'http://cdn1.editmysite.com/';
var STYLE_PREFIX = 'wsite';
//-->
</script>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
<script src='//cdn2.editmysite.com/js/site/main.js?buildTime=1376434471'></script>
<script type='text/javascript'><!--
(function(jQuery){
function initFlyouts(){initPublishedFlyoutMenus([{"id":"726396690557760293","title":"Me","url":"index.html","target":""},{"id":"808496250337225727","title":"Career","url":"career.html","target":""},{"id":"569492662368727462","title":"My Projects","url":"my-projects.html","target":""},{"id":"429966625406939403","title":"Open Source","url":"open-source.html","target":""},{"id":"349731822904646620","title":"Foodies","url":"foodies.html","target":""},{"id":"206257154268343298","title":"lO_Ok","url":"lo_ok.html","target":""}],'300276614648118521',"<li class='wsite-nav-more'><a href='#'>more...<\/a><\/li>",'',false)}
if (jQuery) {
if (jQuery.browser.msie && !window.flyoutMenusRefreshable) window.onload = initFlyouts;
else jQuery(initFlyouts);
}else{
if (Prototype.Browser.IE) window.onload = initFlyouts;
else document.observe('dom:loaded', initFlyouts);
}
})(window._W && _W.jQuery)
//-->
</script>
</head>
<body class='short-header-page wsite-theme-light wsite-page-nodejs-mongodb-on-aws'>
<div id="header-wrap">
			<div class="container">
				<table id="header">
					<tr>
						<td id="header-right">
							<table>
								<tr>
									<td class="phone-number"></td>
									<td class="social"><div style="text-align:left;"><div style="height:0px;overflow:hidden"></div>
<span class="wsite-social wsite-social-default"><a class='first-child wsite-social-item wsite-social-linkedin' href='http://www.linkedin.com/in/murvinlai' target='_blank'><span class='wsite-social-item-inner'></span></a><a class='last-child wsite-social-item wsite-social-mail' href='mailto:murvinlai@gmail.com' target='_blank'><span class='wsite-social-item-inner'></span></a></span>
<div style="height:0px;overflow:hidden"></div></div></td>
									<td class="search"><span class='wsite-search'><form id='wsite-header-search-form' action='/apps/search' method='get'><input type='text' name='q' class='wsite-search-input' autocomplete='off' placeholder='Search'/><span class='wsite-search-button'><span class='wsite-search-button-inner'></span></span></form></span></td>
								</tr>
							</table>
							<div class="clear"></div>
						</td>
					</tr>
				</table>
			</div><!-- end container -->
		</div><!-- end header-wrap -->  		
		
		<div id="nav-wrap">
			<div class="container">
				<table>
					<tr>
						<td id="logo"><span class='wsite-logo'><a href='/'><span id="wsite-title">Murvin Lai</span></a></span></td>
						<td id="nav"><div id="navigation"><ul class='wsite-menu-default'><li id='pg726396690557760293'><a href='/index.html'>Me</a></li><li id='pg808496250337225727'><a href='/career.html'>Career</a></li><li id='pg569492662368727462'><a href='/my-projects.html'>My Projects</a></li><li id='pg429966625406939403'><a href='/open-source.html'>Open Source</a><div class='wsite-menu-wrap' style='display:none'><ul class='wsite-menu'><li id='wsite-nav-614450794933863025'><a href='/install-nodejs.html' ><span class='wsite-menu-title'>Install Node.js</span></a></li><li id='wsite-nav-300276614648118521' class='wsite-nav-current'><a href='/nodejs--mongodb-on-aws.html' ><span class='wsite-menu-title'>Node.JS + MongoDB on AWS</span></a></li><li id='wsite-nav-218762229315266898'><a href='/nodejs--mongodb--mongoose.html' ><span class='wsite-menu-title'>Node.js + MongoDB + Mongoose</span></a></li><li id='wsite-nav-902977441276521032'><a href='/node-crypto-performance.html' ><span class='wsite-menu-title'>Node Crypto Performance</span></a></li><li id='wsite-nav-690953069293855821'><a href='/npm.html' ><span class='wsite-menu-title'>NPM</span></a></li><li id='wsite-nav-492595969137541189'><a href='/my-node-tips.html' ><span class='wsite-menu-title'>My Node Tips</span></a></li><li id='wsite-nav-347824071611654159'><a href='/dev-note.html' ><span class='wsite-menu-title'>Dev NoTe</span></a></li><li id='wsite-nav-866240321685800541'><a href='/req-and-res-in-nodejs.html' ><span class='wsite-menu-title'>Req and Res in Node.js</span></a></li><li id='wsite-nav-466285040814798282'><a href='/remote-http-request.html' ><span class='wsite-menu-title'>Remote HTTP Request</span></a></li></ul></div></li><li id='pg349731822904646620'><a href='/foodies.html'>Foodies</a><div class='wsite-menu-wrap' style='display:none'><ul class='wsite-menu'><li id='wsite-nav-351838702108898061'><a href='/my-menu.html' ><span class='wsite-menu-title'>My Menu</span></a></li></ul></div></li><li id='pg206257154268343298'><a href='/lo_ok.html'>lO_Ok</a></li></ul></div></td>
					</tr>
				</table>
			</div><!-- end container -->
		</div><!-- end nav-wrap -->
	
		<div id="banner-wrap">
			<div class="container">
				<div id="banner">
						<div class="wsite-header"></div>
					<div style="clear:both;"></div>
				</div><!-- end banner -->
			</div><!-- end container -->
		</div><!-- end banner-wrap -->
	
		<div id="main-wrap">
			<div class="container">
				<div id='wsite-content' class='wsite-elements wsite-not-footer'>
<h2 style="text-align:left;">Node.js + MongoDB on AWS EC2</h2>
<div class="paragraph" style="text-align:left;display:block;">Here are the steps to have your Node.js &amp; MongoDB running on AWS EC2 with Ubuntu server.&nbsp;<br /><br />Steps for AWS:<br /><br />1) Start an instance from an Ubuntu AMI.&nbsp;<br />2) Add EBS volume in the popup options before creating the instance.<br />3) Make sure you have the right security group that opens up port 80 and 22.&nbsp;<br />4) After the instance is created, you want to get the EBS mounted properly. &nbsp;That's for storing the MongoDB data. &nbsp;You don't want to store the data in the instance. &nbsp; So, if anything wrong with the instance, you still have the data in EBS protected and mount to another instance later.<br /><ol><li>First, in AWS panel, it will say the EBS is created on device /dev/sdc &nbsp;or sd whatever. &nbsp; The actual device name in Ubuntu will be xvd whatever, e.g. xvdc</li><li>If it is a new EBS with no data, &nbsp;you need to create the file system: &nbsp;<font color="#000000">$ sudo mkfs -t ext4 &lt;device name&gt;</font><br />&lt;device name&gt; is your EBS path, e.g. /dev/xvdc&nbsp;<br /></li><li>Then you create a folder (anywhere, but i suggest under /home/ubuntu). &nbsp;<font color="#000000">/home/ubuntu$ make db</font></li><li>Then mount it: &nbsp;<font color="#000000">/home/ubuntu$ sudo mount &lt;device name&gt; &lt;folder&gt; &nbsp;&nbsp;</font><br />e.g.<font color="#000000">&nbsp;/home/ubuntu$ sudo mount&nbsp;/dev/xvdc db</font></li><li>Now you have the db folder. &nbsp;Then go inside the folder to create a subfolder "data" for holding the actual mongo Data<br /><font color="#000000">/home/ubuntu$ cd db<br />/home/ubuntu$ mkdir data</font></li></ol><br />5) After that, let's install mongo before we do anything with node. &nbsp;Follow this instruction:&nbsp;<a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/" target="_blank">http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/</a><br /><ol><li>In brief, you need to do the followings:<br /><font color="#000000">$ echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | sudo tee /etc/apt/sources.list.d/10gen.list<br />$ sudo apt-get update<br />$ sudo apt-get install mongodb-10gen</font><br /><br /></li><li>After you install, mongo is running.. you may want to start your own mongo and not use their service:<br /><font color="#000000">$ sudo service mongodb stop</font><br /><br /></li><li>Then run mongo from the db/data folder you just created:<br /><font color="#000000">$ sudo /usr/bin/mongod -- dbpath /home/ubuntu/db/data</font></li><li><span style=""></span></li></ol><br /><br />6) Now, you have mongo running. &nbsp;Next, we want to install node. &nbsp;See:&nbsp;<br /><a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager" target="_blank">https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager</a><br /><br /><ol><li>In brief, you need to&nbsp;<br /><font color="#000000">$ sudo apt-get update<br /><span style=""></span>$&nbsp;sudo apt-get install python-software-properties python g++ make<br /><span style=""></span>$&nbsp;sudo add-apt-repository ppa:chris-lea/node.js<br /><span style=""></span>$&nbsp;sudo apt-get update<br /><span style=""></span>$&nbsp;sudo apt-get install nodejs</font><br /><span style=""></span></li><li>If you have previous version of node, then it is quite troublesome, you need to uninstall the previous node first:<br /><font color="#000000">$ sudo&nbsp;







</font><font color="#000000">rm -r bin/node bin/node-waf include/node lib/node lib/pkgconfig/nodejs.pc share/man/man1/node.1</font><br /><span></span><br /><span></span></li></ol>7) After that, you should have the latest node.js and npm installed. &nbsp;<br />8) Next you probably want to install modules like express.js &nbsp; so I suggest you create a folder /home/ubuntu/web &nbsp;and type:<br /><ol><li><font color="#000000">$ sudo npm install express</font><br />or other modules.</li></ol>9) Now what? you want to use git to get your own project running on your new EC2, right?<br /><br /><br /></div></div>

			</div><!-- end container -->
		</div><!-- end main-wrap -->

    <div id="footer-wrap">
        <div class="container">
       		<div class='wsite-elements wsite-footer'>
<div><div class="wsite-multicol"><div class='wsite-multicol-table-wrap' style='margin:0 -15px'>
<table class='wsite-multicol-table'>
<tbody class='wsite-multicol-tbody'>
<tr class='wsite-multicol-tr'>
<td class='wsite-multicol-col' style='width:50%;padding:0 15px'></td>
<td class='wsite-multicol-col' style='width:50%;padding:0 15px'></td>
</tr>
</tbody>
</table>
</div></div></div>

<div class="paragraph">Copyright @2012 Murvinlai.com</div></div>
<script type='text/javascript'>
<!--

if (document.cookie.match(/(^|;)\s*is_mobile=1/)) {
	var windowHref = window.location.href || '';
	if (windowHref.indexOf('?') > -1) {
		windowHref += '&';
	} else {
		windowHref += '?';
	}
	document.write(
		"&nbsp;&nbsp;&nbsp;&nbsp;" +
		"<a class='wsite-view-link-mobile' href='" + windowHref + "view=mobile'>Mobile Site</a>"
	);
}

//-->
</script>

        </div><!-- end container -->
    </div><!-- end footer-wrap -->
	

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22542540-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-7870337-1']);
	_gaq.push(['_setDomainName', 'none']);
	_gaq.push(['_setAllowLinker', true]);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

</script>

<!-- Start Quantcast tag -->
<script type="text/javascript">
	_qoptions={
		qacct:"p-0dYLvhSGGqUWo"
	};
</script>
<script type="text/javascript" src="//edge.quantserve.com/quant.js"></script>
<noscript>
<img src="//pixel.quantserve.com/pixel/p-0dYLvhSGGqUWo.gif" style="display: none;" border="0" height="1" width="1" alt="Quantcast"/>
</noscript>
<!-- End Quantcast tag -->

<script>

	(function(jQuery) {
		try {
			if (jQuery) {
				jQuery('div.blog-social div.fb-like').attr('class', 'blog-social-item blog-fb-like');
				jQuery('#commentArea iframe').css('min-height', '410px');
				if (jQuery('.product-button').length > 0){
					jQuery(document).ready(function(){
						jQuery('.product-button').parent().each(function(index, product){
							if(jQuery(product).attr('target') == 'paypal'){
								if (!jQuery(product).find('> [name="bn"]').length){
									jQuery('<input>').attr({
										type: 'hidden',
										name: 'bn',
										value: 'DragAndDropBuil_SP_EC'
									}).appendTo(product);
								}
							}
						});
						jQuery.ajax({
							type: "GET",
							url: "/ajax/apps/stats.php?stat=sites.commerce.legacy.visit"
						});
					});
					jQuery('.product-button').click(function() {
						var val = jQuery(this.form).serialize();
						jQuery.ajax({
							type: "POST",
							url: "/ajax/apps/stats.php?stat=sites.commerce.legacy.addcart",
							data: { values: val, host: window.location.host }
						});
					});
				}
			}
			else {
				// Prototype
				$$('div.blog-social div.fb-like').each(function(div) {
					div.className = 'blog-social-item blog-fb-like';
				});
				$$('#commentArea iframe').each(function(iframe) {
					iframe.style.minHeight = '410px';
				});
			}
		}
		catch(ex) {}
	})(window._W && _W.jQuery);

</script>

</body>
</html>